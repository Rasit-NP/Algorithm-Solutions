# [Gold III] 한국의 철도 - 34673 

[문제 링크](https://www.acmicpc.net/problem/34673) 

### 성능 요약

메모리: 282760 KB, 시간: 1672 ms

### 분류

수학, 그래프 이론, 자료 구조, 그래프 탐색, 정렬, 트리, 집합과 맵, 조합론, 두 포인터

### 제출 일자

2025년 11월 2일 20:59:54

### 문제 설명

<p>철도를 좋아하는 가희가 사는 한국에는, $1$번 도시부터 $n$번 도시까지 $n$개의 도시가 있으며, $i$번 도시에는 $i$번 역만 있습니다. 열차들은 이 역들에서 운행을 시작하거나 종료할 수 있습니다. 가희는 열차의 운행 방향이 상행과 하행으로 나뉜다는 사실을 알게 되었습니다. 운행을 시작하는 역이 $a$번 도시에 있고, 운행을 종료하는 역이 $b$번 도시에 있다고 할 때, 다음 두 조건 중 하나 이상을 만족하면 상행입니다.</p>

<ul>
<li>$1$번 도시에 있는 역부터 $a$번 도시에 있는 역까지의 거리가 $1$번 도시에 있는 역부터 $b$번 도시에 있는 역까지의 거리보다 더 멉니다.</li>
<li>$1$번 도시에 있는 역부터 $a$번 도시에 있는 역까지의 거리와 $1$번 도시에 있는 역부터 $b$번 도시에 있는 역까지의 거리가 같습니다. 그리고 $b$번 역이 있는 도시의 인구수보다 $a$번 역이 있는 도시의 인구수가 더 많습니다.</li>
</ul>

<p>이때, $a$번 도시에 있는 역부터 $b$번 도시에 있는 역까지 거리는 $a$번 도시에 있는 역에서부터 $b$번 도시에 있는 역까지 이동하는 데 이용한 노선 거리의 합의 최소값 입니다. 또한, 상행의 반대 방향은 하행이며 하행의 반대 방향은 상행입니다. 이 방식으로 상행, 하행을 결정할 수 없다면, 상행도 하행도 아닙니다.</p>

<p>운행 정보는 다음과 같이 정의합니다.</p>

<ul>
<li>$s$번 역에서 운행을 시작하여, $e$번 역에서 운행을 종료합니다.</li>
<li>$s ≠ e$</li>
</ul>

<p>운행을 시작하는 역과 운행을 종료하는 역 중 하나라도 다르다면 다른 운행 정보로 셉니다. 상행으로 운행되는 서로 다른 운행 정보의 개수와, 하행으로 운행되는 서로 다른 운행 정보의 개수를 출력해 주세요.</p>

### 입력 

 <p>첫 번째 줄에 도시의 수 $n$이 주어집니다.</p>

<p>두 번째 줄부터 $n-1$개의 줄에 걸쳐 노선 정보 $s$, $e$, $d$가 공백으로 구분되어 주어집니다. 이는 $s$번 역과 $e$번 역 사이에 거리가 $d$인 양방향으로 연결된 노선이 있음을 의미합니다.</p>

<p>$n+1$번째 줄에 도시의 인구 수 $p_1, p_2, \cdots, p_n$이 공백으로 구분되어 주어집니다.</p>

### 출력 

 <p>첫 번째 줄에 상행으로 운행되는 서로 다른 운행 정보의 개수와 하행으로 운행되는 서로 다른 운행 정보의 개수를 공백으로 구분하여 출력해 주세요.</p>

